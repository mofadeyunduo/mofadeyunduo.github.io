## 功能

将不同的 Key 通过 `Hash` 的方法，使其在不同的 Instance 中，这些 Instance 组成了 Cluster。

满足分布式系统的**高可用、分区容错**的属性。

## 原理

- 初始化：每个 Redis Instance 分配 Bucket 范围
- 首先根据 Key **计算**出 Hash
- 判断该 Hash **处于**哪个 Bucket 之中，从中读取值或者设置值

## 一致性

- 使用 `Gossip` 协议，主动向其他节点推送数据
- 每个 Instance **随机**向自己已知的其他 Instance 发送消息，**同步**集群信息（**currentEpoch、正常节点、异常节点**）
  - 不会**向自己**发送
  - 优先向别人同步给自己的、发现**连接不上**的 Instance 发送，故障快速失效
  - 其次向**很久没有发送消息**的实例发送
  
## 故障发现

- 集群内有人**发现某节点失效**，会把节点**标记**为 `fail?` 的状态
- 如果**集群内 > `50%` 的节点**认为 Master 失效，则 Master **下线**，状态为 `fail`
- 如果有 Slave，**提升 Slave 至 Master**，状态变为 `ok`